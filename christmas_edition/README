Copyright Sebastian Samoilescu 2019

|--------------------------------|
|   Nume:  Sebastian Samoilescu  |
|   Grupa: 325CA                 |
|--------------------------------|

Task1

--> 0x8048666 - bucata de cod ce face parte din print-flag apeleaza functia read cu o dimensiune mai mare 			decat bufferul alocat,  apoi pune in registrul eax o posbilia adresa suprascrisa de citire. In 			final, se cheama functia ce se afla la adresa retinuta de eax. 

Task2

Flag - NICE_FLAG{d3ebdea67df119c0424eb7f383472c38}

Pentru a obtine flag-ul dorit vom suprascrie ce se afla la 'ebp + 0xc' cu adresa de inceput a functie print_flag, astfel incat cand se va apela functia ce se afla la adresa retinuta de eax, sa obtinem flagul.

Task3

Flag - NAUGHTY_FLAG{7cafd00ace9603d03d6dc27d5dd024fd}

---> Observam ca se apeleaza diferite bucati de cod din functia print_flag, unde se face o citire si la final o comparatie intre o zona anume din bufferul alocat si un anumit numar scris in hexa.

---> Pentru ca programul sa isi continue executia dupa un bloc de instructiuni de acest tip este necesar sa punem la o anumita zona din buffer numarul comparat.

---> Pana sa se ajunga la bucata de cod vulnerabila(0x80486d3) se executa 5 astfel de blocuri.

---> In final, plasam la adresa 'ebp + 8' adresa de inceput a functiei print_flag.

Bonus

---> Pentru a deschide un nou shell ar trebui sa ne folosim de procedura denumita "code-injection".

--->Asemanator cu taskul trecut, observam la la adresa  0x80486fe din cadrul functiei print flag se ia de la adresa 'ebp + 8' o noud adresa catre care isi va urma executia programul.

--->Pentru a duce la capat procedeul de code injection vom pune la adresa 'ebp + 12' codul care face sa se deschide un shell(http://shell-storm.org/shellcode/files/shellcode-251.php), iar la adresa 'ebp + 8' vom plasa adresa de inceput a codului de pe stiva.

Mentiuni:
----> La rularea executabilului in gdb primesc notificare de la gdb ca a fost deschis un nou proces /bin/bash

----> Atunci cand rulez executabilul din terminal primesc "seg fault"

Observatii: 

---> pentru a incerca sa rezolv problema de seg fault am adaugat un padding de 'nop' pe stiva

---> ultima parte a payload ului este reprezentata de codul ce va fi executat pentru a deschide un nou shell
